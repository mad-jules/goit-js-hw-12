{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from 'izitoast';\n\naxios.defaults.baseURL = 'https://pixabay.com/api';\n\nexport const getImagesByQuery = async (query, page) => {\n  try {\n    const response = await axios.get('/', {\n      params: {\n        key: '51392413-3a9fe7039391cca55c3ec30ee',\n        q: query.trim().toLowerCase(),\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        page,\n        per_page: 15,\n      },\n    });\n    if (response.data.hits.length === 0) {\n      iziToast.info({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topRight',\n      });\n    }\n    return response.data;\n  } catch (error) {\n    console.error(error);\n  }\n};\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst imgList = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst loadMoreBtn = document.querySelector('.load-more-btn');\n\nconst simpleLightBox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nconst generateMarkup = images => {\n  return images\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) =>\n        `\n    <li class=\"gallery-item\">\n\t<a class=\"gallery-link\" href=\"${largeImageURL}\">\n\t\t<img \n\t\t  class=\"gallery-image\" \n\t\t  src=\"${webformatURL}\"\n\t\t   alt=\"${tags}\"\n       loading=\"lazy\"\n\t\t/>\n\t</a>\n  <ul class=\"statistic-list\">\n  <li>Likes\n  <p>${likes}\n  </p>\n  </li>\n  <li>Views\n  <p>${views}\n  </p>\n  </li>\n  <li>Comments\n  <p>${comments}\n  </p>\n  </li>\n  <li>Downloads\n  <p>${downloads}\n  </p>\n  </li>\n  </ul>\n</li>\n  `\n    )\n    .join('');\n};\n\nconst createGallery = images => {\n  const markup = generateMarkup(images);\n  imgList.innerHTML = markup;\n  simpleLightBox.refresh();\n};\n\nconst appendGallery = images => {\n  const markup = generateMarkup(images);\n  imgList.insertAdjacentHTML('beforeend', markup);\n  simpleLightBox.refresh();\n};\n\nconst clearGallery = () => {\n  imgList.innerHTML = '';\n};\n\nconst isLoaderVisible = () => {\n  return !loader.classList.contains('visually-hidden');\n};\n\nconst showLoader = () => {\n  if (!isLoaderVisible()) {\n    loader.classList.remove('visually-hidden');\n  }\n};\n\nconst hideLoader = () => {\n  if (isLoaderVisible()) {\n    loader.classList.add('visually-hidden');\n  }\n};\n\nconst isLoadMoreVisible = () => {\n  return !loadMoreBtn.classList.contains('visually-hidden');\n};\n\nconst showLoadMoreButton = () => {\n  if (!isLoadMoreVisible()) {\n    loadMoreBtn.classList.remove('visually-hidden');\n  }\n};\nconst hideLoadMoreButton = () => {\n  if (isLoadMoreVisible) {\n    loadMoreBtn.classList.add('visually-hidden');\n  }\n};\n\nconst getCardHeight = () => {\n  const card = imgList.querySelector('.gallery-item');\n  if (card === null) {\n    return 0;\n  }\n  return card.getBoundingClientRect().height;\n};\n\nexport {\n  createGallery,\n  clearGallery,\n  showLoader,\n  hideLoader,\n  showLoadMoreButton,\n  hideLoadMoreButton,\n  appendGallery,\n  getCardHeight,\n  simpleLightBox,\n};\n","import iziToast from 'izitoast';\n\nimport { getImagesByQuery } from './js/pixabay-api';\n\nimport 'izitoast/dist/css/iziToast.min.css';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport {\n  showLoader,\n  createGallery,\n  clearGallery,\n  hideLoader,\n  showLoadMoreButton,\n  hideLoadMoreButton,\n  appendGallery,\n  getCardHeight,\n} from './js/render-functions';\n\nconst formEl = document.querySelector('.form');\nconst loadMoreBtn = document.querySelector('.load-more-btn');\nconst perPage = 15;\n\nlet page = 1;\nlet query = '';\nlet totalPages = null;\nlet cardHeight = null;\n\nformEl.addEventListener('submit', async e => {\n  e.preventDefault();\n  page = 1;\n  query = e.currentTarget.elements['search-text'].value.trim();\n  if (query.length === 0) {\n    iziToast.warning({\n      message: 'Please enter data',\n      position: 'topRight',\n    });\n  } else {\n    clearGallery();\n    showLoader();\n    try {\n      const response = await getImagesByQuery(query, page);\n      const { hits, total, totalHits } = response;\n      totalPages = Math.ceil(totalHits / perPage);\n      createGallery(hits);\n      cardHeight = getCardHeight();\n      if (page < totalPages) {\n        showLoadMoreButton();\n        loadMoreBtn.addEventListener('click', onLoadMoreBtnClick);\n      }\n    } catch (error) {\n      console.error(error);\n    } finally {\n      hideLoader();\n    }\n  }\n});\n\nconst onLoadMoreBtnClick = async e => {\n  e.target.blur();\n  page += 1;\n  try {\n    hideLoadMoreButton();\n    showLoader();\n    const response = await getImagesByQuery(query, page);\n    const { hits, total, totalHits } = response;\n    appendGallery(hits);\n  } catch (error) {\n    console.error(error);\n  } finally {\n    hideLoader();\n    scrollBy({\n      top: cardHeight * 2,\n      behavior: 'smooth',\n    });\n    if (page < totalPages) {\n      showLoadMoreButton();\n    }\n    if (page === totalPages) {\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n      });\n      loadMoreBtn.removeEventListener('click', onLoadMoreBtnClick);\n    }\n  }\n};\n"],"names":["axios","getImagesByQuery","query","page","response","iziToast","error","imgList","loader","loadMoreBtn","simpleLightBox","SimpleLightbox","generateMarkup","images","webformatURL","largeImageURL","tags","likes","views","comments","downloads","createGallery","markup","appendGallery","clearGallery","isLoaderVisible","showLoader","hideLoader","isLoadMoreVisible","showLoadMoreButton","hideLoadMoreButton","getCardHeight","card","formEl","perPage","totalPages","cardHeight","e","hits","total","totalHits","onLoadMoreBtnClick"],"mappings":"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"}